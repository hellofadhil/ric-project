CREATE PROCEDURE SP_FormRicHistories_Get
AS
BEGIN
    SET NOCOUNT ON;

    SELECT *
    FROM FormRicHistories
    WHERE IsDeleted = 0
END
GO

CREATE PROCEDURE SP_FormRicHistories_GetById
    @Id UNIQUEIDENTIFIER
AS
BEGIN
    SET NOCOUNT ON;

    SELECT *
    FROM FormRicHistories
    WHERE Id = @Id AND IsDeleted = 0
END
GO

CREATE PROCEDURE SP_FormRicHistories_Create
    @Id UNIQUEIDENTIFIER,
    @IdFormRic UNIQUEIDENTIFIER,
    @IdEditor UNIQUEIDENTIFIER,
    @Version INT,
    @Snapshot NVARCHAR(MAX),
    @EditedFields NVARCHAR(MAX)
AS
BEGIN
    INSERT INTO FormRicHistories (
        Id, IdFormRic, IdEditor, Version,
        Snapshot, EditedFields,
        CreatedAt, IsDeleted
    )
    VALUES (
        @Id, @IdFormRic, @IdEditor, @Version,
        @Snapshot, @EditedFields,
        SYSDATETIMEOFFSET(), 0
    )
END
GO

CREATE PROCEDURE SP_FormRicHistories_Delete
    @Id UNIQUEIDENTIFIER
AS
BEGIN
    UPDATE FormRicHistories
    SET IsDeleted = 1
    WHERE Id = @Id
END
GO
